[2022-11-10T13:47:54.705+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: load_to_dwh_v2.load_raw_data scheduled__2022-11-09T00:00:00+00:00 [queued]>
[2022-11-10T13:47:54.720+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: load_to_dwh_v2.load_raw_data scheduled__2022-11-09T00:00:00+00:00 [queued]>
[2022-11-10T13:47:54.720+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2022-11-10T13:47:54.720+0000] {taskinstance.py:1363} INFO - Starting attempt 1 of 6
[2022-11-10T13:47:54.721+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2022-11-10T13:47:54.744+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): load_raw_data> on 2022-11-09 00:00:00+00:00
[2022-11-10T13:47:54.749+0000] {standard_task_runner.py:54} INFO - Started process 64 to run task
[2022-11-10T13:47:54.752+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'load_to_dwh_v2', 'load_raw_data', 'scheduled__2022-11-09T00:00:00+00:00', '--job-id', '79', '--raw', '--subdir', 'DAGS_FOLDER/postgre_create_table.py', '--cfg-path', '/tmp/tmprj9gbiuy']
[2022-11-10T13:47:54.753+0000] {standard_task_runner.py:83} INFO - Job 79: Subtask load_raw_data
[2022-11-10T13:47:54.754+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/***/dags/postgre_create_table.py
[2022-11-10T13:47:56.002+0000] {task_command.py:384} INFO - Running <TaskInstance: load_to_dwh_v2.load_raw_data scheduled__2022-11-09T00:00:00+00:00 [running]> on host 7ed92ead7851
[2022-11-10T13:47:56.103+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=nahom
AIRFLOW_CTX_DAG_ID=load_to_dwh_v2
AIRFLOW_CTX_TASK_ID=load_raw_data
AIRFLOW_CTX_EXECUTION_DATE=2022-11-09T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-11-09T00:00:00+00:00
[2022-11-10T13:47:56.104+0000] {logging_mixin.py:117} INFO - writing data..............
[2022-11-10T13:47:56.123+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,123 INFO sqlalchemy.engine.Engine select pg_catalog.version()
[2022-11-10T13:47:56.123+0000] {log.py:117} INFO - select pg_catalog.version()
[2022-11-10T13:47:56.124+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,124 INFO sqlalchemy.engine.Engine [raw sql] {}
[2022-11-10T13:47:56.124+0000] {log.py:117} INFO - [raw sql] {}
[2022-11-10T13:47:56.125+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,125 INFO sqlalchemy.engine.Engine select current_schema()
[2022-11-10T13:47:56.125+0000] {log.py:117} INFO - select current_schema()
[2022-11-10T13:47:56.125+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,125 INFO sqlalchemy.engine.Engine [raw sql] {}
[2022-11-10T13:47:56.125+0000] {log.py:117} INFO - [raw sql] {}
[2022-11-10T13:47:56.126+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,126 INFO sqlalchemy.engine.Engine show standard_conforming_strings
[2022-11-10T13:47:56.126+0000] {log.py:117} INFO - show standard_conforming_strings
[2022-11-10T13:47:56.127+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,127 INFO sqlalchemy.engine.Engine [raw sql] {}
[2022-11-10T13:47:56.127+0000] {log.py:117} INFO - [raw sql] {}
[2022-11-10T13:47:56.128+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,128 INFO sqlalchemy.engine.Engine select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
[2022-11-10T13:47:56.128+0000] {log.py:117} INFO - select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s
[2022-11-10T13:47:56.128+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,128 INFO sqlalchemy.engine.Engine [generated in 0.00045s] {'name': 'traffic_raw'}
[2022-11-10T13:47:56.128+0000] {log.py:117} INFO - [generated in 0.00045s] {'name': 'traffic_raw'}
[2022-11-10T13:47:56.132+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,132 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-11-10T13:47:56.132+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-11-10T13:47:56.133+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,133 INFO sqlalchemy.engine.Engine 
CREATE TABLE traffic_raw (
	id BIGINT, 
	track_id BIGINT, 
	type TEXT, 
	traveled_d FLOAT(53), 
	avg_speed FLOAT(53), 
	lat FLOAT(53), 
	lon FLOAT(53), 
	speed FLOAT(53), 
	lon_acc FLOAT(53), 
	lat_acc FLOAT(53), 
	time FLOAT(53)
)
[2022-11-10T13:47:56.133+0000] {log.py:117} INFO - 
CREATE TABLE traffic_raw (
	id BIGINT, 
	track_id BIGINT, 
	type TEXT, 
	traveled_d FLOAT(53), 
	avg_speed FLOAT(53), 
	lat FLOAT(53), 
	lon FLOAT(53), 
	speed FLOAT(53), 
	lon_acc FLOAT(53), 
	lat_acc FLOAT(53), 
	time FLOAT(53)
)


[2022-11-10T13:47:56.134+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,133 INFO sqlalchemy.engine.Engine [no key 0.00032s] {}
[2022-11-10T13:47:56.133+0000] {log.py:117} INFO - [no key 0.00032s] {}
[2022-11-10T13:47:56.146+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,145 INFO sqlalchemy.engine.Engine CREATE INDEX ix_traffic_raw_id ON traffic_raw (id)
[2022-11-10T13:47:56.145+0000] {log.py:117} INFO - CREATE INDEX ix_traffic_raw_id ON traffic_raw (id)
[2022-11-10T13:47:56.146+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,146 INFO sqlalchemy.engine.Engine [no key 0.00040s] {}
[2022-11-10T13:47:56.146+0000] {log.py:117} INFO - [no key 0.00040s] {}
[2022-11-10T13:47:56.151+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,151 INFO sqlalchemy.engine.Engine COMMIT
[2022-11-10T13:47:56.151+0000] {log.py:117} INFO - COMMIT
[2022-11-10T13:47:56.174+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,174 INFO sqlalchemy.engine.Engine BEGIN (implicit)
[2022-11-10T13:47:56.174+0000] {log.py:117} INFO - BEGIN (implicit)
[2022-11-10T13:47:56.256+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,255 INFO sqlalchemy.engine.Engine INSERT INTO traffic_raw (id, track_id, type, traveled_d, avg_speed, lat, lon, speed, lon_acc, lat_acc, time) VALUES (%(id)s, %(track_id)s, %(type)s, %(traveled_d)s, %(avg_speed)s, %(lat)s, %(lon)s, %(speed)s, %(lon_acc)s, %(lat_acc)s, %(time)s)
[2022-11-10T13:47:56.255+0000] {log.py:117} INFO - INSERT INTO traffic_raw (id, track_id, type, traveled_d, avg_speed, lat, lon, speed, lon_acc, lat_acc, time) VALUES (%(id)s, %(track_id)s, %(type)s, %(traveled_d)s, %(avg_speed)s, %(lat)s, %(lon)s, %(speed)s, %(lon_acc)s, %(lat_acc)s, %(time)s)
[2022-11-10T13:47:56.256+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,256 INFO sqlalchemy.engine.Engine [generated in 0.06180s] ({'id': 0, 'track_id': 1, 'type': ' Car', 'traveled_d': 419.73, 'avg_speed': 33.728231, 'lat': 37.982482, 'lon': 23.729523, 'speed': 31.031, 'lon_acc': 0.0476, 'lat_acc': -0.0501, 'time': 0.0}, {'id': 1, 'track_id': 2, 'type': ' Car', 'traveled_d': 173.65, 'avg_speed': 33.609869, 'lat': 37.979914, 'lon': 23.733339, 'speed': 40.492, 'lon_acc': -0.0074, 'lat_acc': -0.1593, 'time': 0.0}, {'id': 2, 'track_id': 3, 'type': ' Car', 'traveled_d': 374.39, 'avg_speed': 31.938416, 'lat': 37.979915, 'lon': 23.733292, 'speed': 44.2296, 'lon_acc': -0.0142, 'lat_acc': -0.1395, 'time': 0.0}, {'id': 3, 'track_id': 4, 'type': ' Motorcycle', 'traveled_d': 471.19, 'avg_speed': 58.091304, 'lat': 37.979891, 'lon': 23.733233, 'speed': 64.7725, 'lon_acc': 0.0326, 'lat_acc': -0.1309, 'time': 0.0}, {'id': 4, 'track_id': 5, 'type': ' Car', 'traveled_d': 465.16, 'avg_speed': 56.957816, 'lat': 37.979942, 'lon': 23.73322, 'speed': 47.1936, 'lon_acc': -0.0387, 'lat_acc': -0.2323, 'time': 0.0}, {'id': 5, 'track_id': 6, 'type': ' Car', 'traveled_d': 363.4, 'avg_speed': 33.544162, 'lat': 37.98001, 'lon': 23.733218, 'speed': 44.3073, 'lon_acc': -0.0273, 'lat_acc': -0.192, 'time': 0.0}, {'id': 6, 'track_id': 7, 'type': ' Motorcycle', 'traveled_d': 280.83, 'avg_speed': 32.197439, 'lat': 37.979985, 'lon': 23.733131, 'speed': 55.9541, 'lon_acc': 0.0463, 'lat_acc': 0.2381, 'time': 0.0}, {'id': 7, 'track_id': 8, 'type': ' Car', 'traveled_d': 442.63, 'avg_speed': 34.640822, 'lat': 37.980139, 'lon': 23.733109, 'speed': 46.4509, 'lon_acc': -0.0088, 'lat_acc': -0.1975, 'time': 0.0}  ... displaying 10 of 2495 total bound parameter sets ...  {'id': 2493, 'track_id': 2494, 'type': ' Motorcycle', 'traveled_d': 31.48, 'avg_speed': 94.437932, 'lat': 37.979873, 'lon': 23.733336, 'speed': 98.8912, 'lon_acc': -1.8008, 'lat_acc': 0.7762, 'time': 801.6}, {'id': 2494, 'track_id': 2495, 'type': ' Medium Vehicle', 'traveled_d': 6.87, 'avg_speed': 30.906398, 'lat': 37.979854, 'lon': 23.733287, 'speed': 32.5331, 'lon_acc': -0.0, 'lat_acc': -0.0, 'time': 802.0})
[2022-11-10T13:47:56.256+0000] {log.py:117} INFO - [generated in 0.06180s] ({'id': 0, 'track_id': 1, 'type': ' Car', 'traveled_d': 419.73, 'avg_speed': 33.728231, 'lat': 37.982482, 'lon': 23.729523, 'speed': 31.031, 'lon_acc': 0.0476, 'lat_acc': -0.0501, 'time': 0.0}, {'id': 1, 'track_id': 2, 'type': ' Car', 'traveled_d': 173.65, 'avg_speed': 33.609869, 'lat': 37.979914, 'lon': 23.733339, 'speed': 40.492, 'lon_acc': -0.0074, 'lat_acc': -0.1593, 'time': 0.0}, {'id': 2, 'track_id': 3, 'type': ' Car', 'traveled_d': 374.39, 'avg_speed': 31.938416, 'lat': 37.979915, 'lon': 23.733292, 'speed': 44.2296, 'lon_acc': -0.0142, 'lat_acc': -0.1395, 'time': 0.0}, {'id': 3, 'track_id': 4, 'type': ' Motorcycle', 'traveled_d': 471.19, 'avg_speed': 58.091304, 'lat': 37.979891, 'lon': 23.733233, 'speed': 64.7725, 'lon_acc': 0.0326, 'lat_acc': -0.1309, 'time': 0.0}, {'id': 4, 'track_id': 5, 'type': ' Car', 'traveled_d': 465.16, 'avg_speed': 56.957816, 'lat': 37.979942, 'lon': 23.73322, 'speed': 47.1936, 'lon_acc': -0.0387, 'lat_acc': -0.2323, 'time': 0.0}, {'id': 5, 'track_id': 6, 'type': ' Car', 'traveled_d': 363.4, 'avg_speed': 33.544162, 'lat': 37.98001, 'lon': 23.733218, 'speed': 44.3073, 'lon_acc': -0.0273, 'lat_acc': -0.192, 'time': 0.0}, {'id': 6, 'track_id': 7, 'type': ' Motorcycle', 'traveled_d': 280.83, 'avg_speed': 32.197439, 'lat': 37.979985, 'lon': 23.733131, 'speed': 55.9541, 'lon_acc': 0.0463, 'lat_acc': 0.2381, 'time': 0.0}, {'id': 7, 'track_id': 8, 'type': ' Car', 'traveled_d': 442.63, 'avg_speed': 34.640822, 'lat': 37.980139, 'lon': 23.733109, 'speed': 46.4509, 'lon_acc': -0.0088, 'lat_acc': -0.1975, 'time': 0.0}  ... displaying 10 of 2495 total bound parameter sets ...  {'id': 2493, 'track_id': 2494, 'type': ' Motorcycle', 'traveled_d': 31.48, 'avg_speed': 94.437932, 'lat': 37.979873, 'lon': 23.733336, 'speed': 98.8912, 'lon_acc': -1.8008, 'lat_acc': 0.7762, 'time': 801.6}, {'id': 2494, 'track_id': 2495, 'type': ' Medium Vehicle', 'traveled_d': 6.87, 'avg_speed': 30.906398, 'lat': 37.979854, 'lon': 23.733287, 'speed': 32.5331, 'lon_acc': -0.0, 'lat_acc': -0.0, 'time': 802.0})
[2022-11-10T13:47:56.380+0000] {logging_mixin.py:117} INFO - 2022-11-10 13:47:56,380 INFO sqlalchemy.engine.Engine COMMIT
[2022-11-10T13:47:56.380+0000] {log.py:117} INFO - COMMIT
[2022-11-10T13:47:56.383+0000] {logging_mixin.py:117} INFO - !!!!Done!!!!
[2022-11-10T13:47:56.383+0000] {python.py:177} INFO - Done. Returned value was: None
[2022-11-10T13:47:56.394+0000] {taskinstance.py:1406} INFO - Marking task as SUCCESS. dag_id=load_to_dwh_v2, task_id=load_raw_data, execution_date=20221109T000000, start_date=20221110T134754, end_date=20221110T134756
[2022-11-10T13:47:56.450+0000] {local_task_job.py:164} INFO - Task exited with return code 0
[2022-11-10T13:47:56.499+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
